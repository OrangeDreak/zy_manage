import{r as s,c as p,e as d,w as l,f as u,h as g,I as m,k as f}from"./index-CRB7mnJR.js";/* empty css              */import{_ as b}from"./_plugin-vue_export-helper-DlAUqK2U.js";const C=(e,t,r)=>s({url:"/admin/dict/list",method:"post",data:r}),w=e=>s({url:"/admin/dict/remove?id="+e,method:"post",params:{ids:e}}),v=e=>s({url:"/admin/dict/submit",method:"post",data:e}),S=e=>s({url:"/admin/dict/submit",method:"post",data:e}),_=e=>s({url:"/admin/dict/detail",method:"get",params:{id:e}}),y=()=>s({url:"/admin/dict/tree?code=DICT",method:"get"}),D={data(){return{form:{},selectionList:[],loading:!0,query:{},page:{pageSize:10,currentPage:1,total:0},option:{searchShow:!0,searchMenuSpan:6,tip:!1,tree:!0,border:!0,index:!0,selection:!1,viewBtn:!0,menuWidth:300,column:[{label:"字典编号",prop:"code",search:!0,span:24,rules:[{required:!0,message:"请输入字典编号",trigger:"blur"}]},{label:"字典名称",prop:"dictValue",search:!0,rules:[{required:!0,message:"请输入字典名称",trigger:"blur"}]},{label:"上级字典",prop:"parentId",type:"tree",dicData:[],hide:!0,props:{label:"title"},rules:[{required:!1,message:"请选择上级字典",trigger:"click"}]},{label:"字典键值",prop:"dictKey",type:"number",rules:[{required:!0,message:"请输入字典键值",trigger:"blur"}]},{label:"字典排序",prop:"sort",type:"number",rules:[{required:!0,message:"请输入字典排序",trigger:"blur"}]},{label:"字典备注",prop:"remark",search:!0,span:24,hide:!0}]},data:[]}},computed:{ids(){let e=[];return this.selectionList.forEach(t=>{e.push(t.id)}),e.join(",")}},methods:{handleAdd(e){this.$refs.crud.option.column.filter(t=>{t.prop==="code"&&(t.value=e.code,t.addDisabled=!0),t.prop==="parentId"&&(t.value=e.id,t.addDisabled=!0)}),this.$refs.crud.rowAdd()},rowSave(e,t,r){v(e).then(()=>{t(),this.onLoad(this.page),this.$message({type:"success",message:"操作成功!"})},n=>{window.console.log(n),r()})},rowUpdate(e,t,r,n){S(e).then(()=>{r(),this.onLoad(this.page),this.$message({type:"success",message:"操作成功!"})},o=>{window.console.log(o),n()})},rowDel(e){this.$confirm("确定将选择数据删除?",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>w(e.id)).then(()=>{this.onLoad(this.page),this.$message({type:"success",message:"操作成功!"})})},searchReset(){this.query={},this.onLoad(this.page)},searchChange(e,t){this.query=e,this.page.currentPage=1,this.onLoad(this.page,e),t()},selectionChange(e){this.selectionList=e},beforeOpen(e,t){["edit","view"].includes(t)&&_(this.form.id).then(r=>{this.form=r.data}),e()},beforeClose(e,t){this.$refs.crud.option.column.filter(r=>{r.prop==="code"&&(r.value="",r.addDisabled=!1),r.prop==="parentId"&&(r.value="",r.addDisabled=!1)}),e()},currentChange(e){this.page.currentPage=e},sizeChange(e){this.page.pageSize=e},onLoad(e,t={}){this.loading=!0,C(e.currentPage,e.pageSize,Object.assign(t,this.query)).then(r=>{this.data=r.data,this.loading=!1,y().then(n=>{const o=this.findObject(this.option.column,"parentId");o.dicData=n.data})})}}},L={class:"basic-container"};function x(e,t,r,n,o,a){const c=u("el-button"),h=u("avue-crud");return g(),p("div",L,[d(h,{option:o.option,"table-loading":o.loading,data:o.data,ref:"crud",modelValue:o.form,"onUpdate:modelValue":t[0]||(t[0]=i=>o.form=i),"before-open":a.beforeOpen,"before-close":a.beforeClose,onRowDel:a.rowDel,onRowUpdate:a.rowUpdate,onRowSave:a.rowSave,onSearchChange:a.searchChange,onSearchReset:a.searchReset,onSelectionChange:a.selectionChange,onCurrentChange:a.currentChange,onSizeChange:a.sizeChange,onOnLoad:a.onLoad},{menu:l((i,q)=>[d(c,{type:"text",icon:"el-icon-circle-plus-outline",size:"small",onClick:m(R=>a.handleAdd(i.row),["stop"])},{default:l(()=>t[1]||(t[1]=[f("新增子项 ")])),_:2},1032,["onClick"])]),_:1},8,["option","table-loading","data","modelValue","before-open","before-close","onRowDel","onRowUpdate","onRowSave","onSearchChange","onSearchReset","onSelectionChange","onCurrentChange","onSizeChange","onOnLoad"])])}const O=b(D,[["render",x]]);export{O as default};
